<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-using-uaa" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.4.0">
<title data-rh="true">Using JHipster UAA for Microservice Security | JHipster</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://mraible.github.io/images/twitter-card.png"><meta data-rh="true" name="twitter:image" content="https://mraible.github.io/images/twitter-card.png"><meta data-rh="true" property="og:url" content="https://mraible.github.io/using-uaa/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="author" content="JHipster Team"><meta data-rh="true" name="twitter:site" content="@jhipster"><meta data-rh="true" name="google-site-verification" content="JSA7VC5gSwD5KKbXlxK8F9rXJtC91rKJq0aWhfpBC0k"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Using JHipster UAA for Microservice Security | JHipster"><meta data-rh="true" name="description" content="JHipster UAA is a user accounting and authorizing service for securing JHipster microservices using the OAuth2 authorization protocol."><meta data-rh="true" property="og:description" content="JHipster UAA is a user accounting and authorizing service for securing JHipster microservices using the OAuth2 authorization protocol."><link data-rh="true" rel="icon" href="/images/favicon.ico"><link data-rh="true" rel="canonical" href="https://mraible.github.io/using-uaa/"><link data-rh="true" rel="alternate" href="https://mraible.github.io/using-uaa/" hreflang="en"><link data-rh="true" rel="alternate" href="https://mraible.github.io/using-uaa/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="JHipster" href="/opensearch.xml">


<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400..900&amp;display=fallback" as="style" onload="this.rel=&#39;stylesheet&#39;">

<script type="application/ld+json">{"@context":"https://schema.org/","@type":"Organization","name":"JHipster","url":"https://www.jhipster.tech","logo":"https://www.jhipster.tech/images/logo/logo.svg","sameAs":["https://x.com/jhipster","https://github.com/jhipster/generator-jhipster"]}</script><link rel="stylesheet" href="/assets/css/styles.4b2da36a.css">
<script src="/assets/js/runtime~main.1f8d4b2b.js" defer="defer"></script>
<script src="/assets/js/main.8babaa90.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/images/logo/logo-light.svg" alt="JHipster Logo" class="themedComponent_mlkZ themedComponent--light_NVdE" height="32" width="140"><img src="/images/logo/logo-dark.svg" alt="JHipster Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="32" width="140"></div></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/getting-started">Docs</a><a class="navbar__item navbar__link" href="/modules/marketplace/">Marketplace</a><a class="navbar__item navbar__link" href="/team/">Team</a><a class="navbar__item navbar__link" href="/sponsors/">Sponsors</a><a href="https://start.jhipster.tech/jdl-studio/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">JDL Studio<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><ul class="socialLinks_LGM8 socialLinks_RXhx"><li><a href="https://x.com/jhipster" target="_blank" rel="noopener noreferrer" aria-label="X"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"></path></svg></a></li><li><a href="https://github.com/jhipster/generator-jhipster" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></li><li><a href="https://www.youtube.com/c/JHipsterDevelopersAssociation" target="_blank" rel="noopener noreferrer" aria-label="YouTube channel"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 576 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"></path></svg></a></li><li><a href="https://gitter.im/jhipster/generator-jhipster" target="_blank" rel="noopener noreferrer" aria-label="Gitter"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 384 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M66.4 322.5H16V0h50.4v322.5zM166.9 76.1h-50.4V512h50.4V76.1zm100.6 0h-50.4V512h50.4V76.1zM368 76h-50.4v247H368V76z"></path></svg></a></li></ul><div class="toggle_nTvT colorModeToggle_SKOt"><button class="clean-btn toggleButton_gYZh toggleButtonDisabled_zh5C" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg stroke="currentColor" fill="none" stroke-width="0" viewBox="0 0 15 15" class="toggleIcon_U8RU lightToggleIcon_W4D2" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M7.5 0C7.77614 0 8 0.223858 8 0.5V2.5C8 2.77614 7.77614 3 7.5 3C7.22386 3 7 2.77614 7 2.5V0.5C7 0.223858 7.22386 0 7.5 0ZM2.1967 2.1967C2.39196 2.00144 2.70854 2.00144 2.90381 2.1967L4.31802 3.61091C4.51328 3.80617 4.51328 4.12276 4.31802 4.31802C4.12276 4.51328 3.80617 4.51328 3.61091 4.31802L2.1967 2.90381C2.00144 2.70854 2.00144 2.39196 2.1967 2.1967ZM0.5 7C0.223858 7 0 7.22386 0 7.5C0 7.77614 0.223858 8 0.5 8H2.5C2.77614 8 3 7.77614 3 7.5C3 7.22386 2.77614 7 2.5 7H0.5ZM2.1967 12.8033C2.00144 12.608 2.00144 12.2915 2.1967 12.0962L3.61091 10.682C3.80617 10.4867 4.12276 10.4867 4.31802 10.682C4.51328 10.8772 4.51328 11.1938 4.31802 11.3891L2.90381 12.8033C2.70854 12.9986 2.39196 12.9986 2.1967 12.8033ZM12.5 7C12.2239 7 12 7.22386 12 7.5C12 7.77614 12.2239 8 12.5 8H14.5C14.7761 8 15 7.77614 15 7.5C15 7.22386 14.7761 7 14.5 7H12.5ZM10.682 4.31802C10.4867 4.12276 10.4867 3.80617 10.682 3.61091L12.0962 2.1967C12.2915 2.00144 12.608 2.00144 12.8033 2.1967C12.9986 2.39196 12.9986 2.70854 12.8033 2.90381L11.3891 4.31802C11.1938 4.51328 10.8772 4.51328 10.682 4.31802ZM8 12.5C8 12.2239 7.77614 12 7.5 12C7.22386 12 7 12.2239 7 12.5V14.5C7 14.7761 7.22386 15 7.5 15C7.77614 15 8 14.7761 8 14.5V12.5ZM10.682 10.682C10.8772 10.4867 11.1938 10.4867 11.3891 10.682L12.8033 12.0962C12.9986 12.2915 12.9986 12.608 12.8033 12.8033C12.608 12.9986 12.2915 12.9986 12.0962 12.8033L10.682 11.3891C10.4867 11.1938 10.4867 10.8772 10.682 10.682ZM5.5 7.5C5.5 6.39543 6.39543 5.5 7.5 5.5C8.60457 5.5 9.5 6.39543 9.5 7.5C9.5 8.60457 8.60457 9.5 7.5 9.5C6.39543 9.5 5.5 8.60457 5.5 7.5ZM7.5 4.5C5.84315 4.5 4.5 5.84315 4.5 7.5C4.5 9.15685 5.84315 10.5 7.5 10.5C9.15685 10.5 10.5 9.15685 10.5 7.5C10.5 5.84315 9.15685 4.5 7.5 4.5Z" fill="currentColor"></path></svg><svg stroke="currentColor" fill="none" stroke-width="0" viewBox="0 0 15 15" class="toggleIcon_U8RU darkToggleIcon_vNJO" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.89998 0.499976C2.89998 0.279062 2.72089 0.0999756 2.49998 0.0999756C2.27906 0.0999756 2.09998 0.279062 2.09998 0.499976V1.09998H1.49998C1.27906 1.09998 1.09998 1.27906 1.09998 1.49998C1.09998 1.72089 1.27906 1.89998 1.49998 1.89998H2.09998V2.49998C2.09998 2.72089 2.27906 2.89998 2.49998 2.89998C2.72089 2.89998 2.89998 2.72089 2.89998 2.49998V1.89998H3.49998C3.72089 1.89998 3.89998 1.72089 3.89998 1.49998C3.89998 1.27906 3.72089 1.09998 3.49998 1.09998H2.89998V0.499976ZM5.89998 3.49998C5.89998 3.27906 5.72089 3.09998 5.49998 3.09998C5.27906 3.09998 5.09998 3.27906 5.09998 3.49998V4.09998H4.49998C4.27906 4.09998 4.09998 4.27906 4.09998 4.49998C4.09998 4.72089 4.27906 4.89998 4.49998 4.89998H5.09998V5.49998C5.09998 5.72089 5.27906 5.89998 5.49998 5.89998C5.72089 5.89998 5.89998 5.72089 5.89998 5.49998V4.89998H6.49998C6.72089 4.89998 6.89998 4.72089 6.89998 4.49998C6.89998 4.27906 6.72089 4.09998 6.49998 4.09998H5.89998V3.49998ZM1.89998 6.49998C1.89998 6.27906 1.72089 6.09998 1.49998 6.09998C1.27906 6.09998 1.09998 6.27906 1.09998 6.49998V7.09998H0.499976C0.279062 7.09998 0.0999756 7.27906 0.0999756 7.49998C0.0999756 7.72089 0.279062 7.89998 0.499976 7.89998H1.09998V8.49998C1.09998 8.72089 1.27906 8.89997 1.49998 8.89997C1.72089 8.89997 1.89998 8.72089 1.89998 8.49998V7.89998H2.49998C2.72089 7.89998 2.89998 7.72089 2.89998 7.49998C2.89998 7.27906 2.72089 7.09998 2.49998 7.09998H1.89998V6.49998ZM8.54406 0.98184L8.24618 0.941586C8.03275 0.917676 7.90692 1.1655 8.02936 1.34194C8.17013 1.54479 8.29981 1.75592 8.41754 1.97445C8.91878 2.90485 9.20322 3.96932 9.20322 5.10022C9.20322 8.37201 6.82247 11.0878 3.69887 11.6097C3.45736 11.65 3.20988 11.6772 2.96008 11.6906C2.74563 11.702 2.62729 11.9535 2.77721 12.1072C2.84551 12.1773 2.91535 12.2458 2.98667 12.3128L3.05883 12.3795L3.31883 12.6045L3.50684 12.7532L3.62796 12.8433L3.81491 12.9742L3.99079 13.089C4.11175 13.1651 4.23536 13.2375 4.36157 13.3059L4.62496 13.4412L4.88553 13.5607L5.18837 13.6828L5.43169 13.7686C5.56564 13.8128 5.70149 13.8529 5.83857 13.8885C5.94262 13.9155 6.04767 13.9401 6.15405 13.9622C6.27993 13.9883 6.40713 14.0109 6.53544 14.0298L6.85241 14.0685L7.11934 14.0892C7.24637 14.0965 7.37436 14.1002 7.50322 14.1002C11.1483 14.1002 14.1032 11.1453 14.1032 7.50023C14.1032 7.25044 14.0893 7.00389 14.0623 6.76131L14.0255 6.48407C13.991 6.26083 13.9453 6.04129 13.8891 5.82642C13.8213 5.56709 13.7382 5.31398 13.6409 5.06881L13.5279 4.80132L13.4507 4.63542L13.3766 4.48666C13.2178 4.17773 13.0353 3.88295 12.8312 3.60423L12.6782 3.40352L12.4793 3.16432L12.3157 2.98361L12.1961 2.85951L12.0355 2.70246L11.8134 2.50184L11.4925 2.24191L11.2483 2.06498L10.9562 1.87446L10.6346 1.68894L10.3073 1.52378L10.1938 1.47176L9.95488 1.3706L9.67791 1.2669L9.42566 1.1846L9.10075 1.09489L8.83599 1.03486L8.54406 0.98184ZM10.4032 5.30023C10.4032 4.27588 10.2002 3.29829 9.83244 2.40604C11.7623 3.28995 13.1032 5.23862 13.1032 7.50023C13.1032 10.593 10.596 13.1002 7.50322 13.1002C6.63646 13.1002 5.81597 12.9036 5.08355 12.5522C6.5419 12.0941 7.81081 11.2082 8.74322 10.0416C8.87963 10.2284 9.10028 10.3497 9.34928 10.3497C9.76349 10.3497 10.0993 10.0139 10.0993 9.59971C10.0993 9.24256 9.84965 8.94373 9.51535 8.86816C9.57741 8.75165 9.63653 8.63334 9.6926 8.51332C9.88358 8.63163 10.1088 8.69993 10.35 8.69993C11.0403 8.69993 11.6 8.14028 11.6 7.44993C11.6 6.75976 11.0406 6.20024 10.3505 6.19993C10.3853 5.90487 10.4032 5.60464 10.4032 5.30023Z" fill="currentColor"></path></svg></button></div><div class="navbarSearchContainer_qtpJ"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Using JHipster UAA for Microservice Security</h1></header><p>JHipster UAA is a user accounting and authorizing service for securing JHipster microservices using the OAuth2 authorization protocol.</p>
<p>To distinguish JHipster UAA from other &quot;UAA&quot;s such as <a href="https://github.com/cloudfoundry/uaa" target="_blank" rel="noopener noreferrer">Cloudfoundry UAA</a>, JHipster UAA is a fully configured OAuth2 authorization server with the users and roles endpoints inside, wrapped into a usual JHipster application. This allows the developer to deeply configure every aspect of the user domain, without restricting on policies by other ready-to-use UAAs.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="architecture-diagram">Architecture diagram<a class="hash-link" aria-label="Direct link to Architecture diagram" title="Direct link to Architecture diagram" href="/using-uaa/#architecture-diagram">​</a></h2>
<p><img decoding="async" loading="lazy" alt="Diagram" src="/assets/images/microservices_architecture_detail.002-754db5cd5f5ed8d26cd2d325ec8976f3.png" width="1024" height="768" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-security-claims-of-microservice-architecture">1. Security claims of microservice architecture<a class="hash-link" aria-label="Direct link to 1. Security claims of microservice architecture" title="Direct link to 1. Security claims of microservice architecture" href="/using-uaa/#1-security-claims-of-microservice-architecture">​</a></h2>
<p>Before digging into OAuth2 and its application on JHipster microservices, it&#x27;s important to clarify the claims to a solid security solution.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-central-authentication">1. Central authentication<a class="hash-link" aria-label="Direct link to 1. Central authentication" title="Direct link to 1. Central authentication" href="/using-uaa/#1-central-authentication">​</a></h3>
<p>Since microservices is about building mostly independent and autonomous applications, we want to have a consistent authentication experience, so the users won&#x27;t notice their requests are served by different applications with possibly individual security configuration.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-statelessness">2. Statelessness<a class="hash-link" aria-label="Direct link to 2. Statelessness" title="Direct link to 2. Statelessness" href="/using-uaa/#2-statelessness">​</a></h3>
<p>The core benefit of building microservices is scalability. So the chosen security solution shouldn&#x27;t affect this. Holding the users session state on server becomes a tricky task, so a stateless solution is highly preferred in this scenario.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-usermachine-access-distinction">3. User/machine access distinction<a class="hash-link" aria-label="Direct link to 3. User/machine access distinction" title="Direct link to 3. User/machine access distinction" href="/using-uaa/#3-usermachine-access-distinction">​</a></h3>
<p>There is a need of having a clear distinction of different users, and also different machines. Using microservice architecture leads to building a large multi-purpose data-center of different domains and resources, so there is a need to restrict different clients, such as native apps, multiple single page applications etc. in their access.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-fine-grained-access-control">4. Fine-grained access control<a class="hash-link" aria-label="Direct link to 4. Fine-grained access control" title="Direct link to 4. Fine-grained access control" href="/using-uaa/#4-fine-grained-access-control">​</a></h3>
<p>While maintaining centralized roles, there is a need of configuring detailed access control policies in each microservice. A microservice should be unaware of the responsibility of recognizing users, and must authorize incoming requests.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-safe-from-attacks">5. Safe from attacks<a class="hash-link" aria-label="Direct link to 5. Safe from attacks" title="Direct link to 5. Safe from attacks" href="/using-uaa/#5-safe-from-attacks">​</a></h3>
<p>No matter how much problems a security solution may solve, it should be strong against vulnerabilities as best as possible.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6-scalability">6. Scalability<a class="hash-link" aria-label="Direct link to 6. Scalability" title="Direct link to 6. Scalability" href="/using-uaa/#6-scalability">​</a></h3>
<p>Using stateless protocols is not a warranty of the security solution is scalable. In the end, there should not be any single point of failure. A counter-example is a shared auth database or single auth-server-instance, which is hit once per request.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-understanding-oauth2-in-this-context">2. Understanding OAuth2 in this context<a class="hash-link" aria-label="Direct link to 2. Understanding OAuth2 in this context" title="Direct link to 2. Understanding OAuth2 in this context" href="/using-uaa/#2-understanding-oauth2-in-this-context">​</a></h2>
<p>Using the OAuth2 protocol (note: it&#x27;s a <strong>protocol</strong>, not a framework, not an application) is satisfying all 6 claims. It follows strict standards, what makes this solution compatible to other microservices as well, and remote systems, too. JHipster provides a couple of solutions, based on the following security design:</p>
<p><img decoding="async" loading="lazy" alt="JHipster UAA architecture" src="/assets/images/jhipster_uaa-014acad4b698a3efb39b1d96e00bb74c.png" width="802" height="800" class="img_ev3q"></p>
<ul>
<li>Every request to any endpoint of the architecture is performed via an &quot;client&quot;</li>
<li>A &quot;client&quot; is an abstract word for things like &quot;Angular $http client&quot;, some &quot;REST-Client&quot;, &quot;curl&quot;, or anything able to perform requests.</li>
<li>A &quot;client&quot; may also be used in conjunction with user authentication, like the Angular $http in the frontend client application</li>
<li>Every microservice serving resources on endpoints (including the UAA), are resource servers</li>
<li>Blue arrows show clients authenticate on an Oauth authorization server</li>
<li>Green arrows show requests on resource servers performed by the client</li>
<li>The UAA server is a combination of authorization server and resource server</li>
<li>The UAA server is the owner of all the data inside the microservice applications (it approves automatically access to resource servers)</li>
<li>Clients accessing resources with user authentication, are authenticated using &quot;password grant&quot; with the client ID and secret safely stored in the gateway configuration files</li>
<li>Clients accessing resources without user, are authenticated using &quot;client credentials grant&quot;</li>
<li>Every client is defined inside UAA (web-app, internal, ...)</li>
</ul>
<p>This design may be applied to any microservice architecture independent from language or framework.</p>
<p>As an addition, the following rules can be applied for access control:</p>
<ul>
<li>User access is configured using &quot;roles&quot; and <a href="https://de.wikipedia.org/wiki/Role_Based_Access_Control" target="_blank" rel="noopener noreferrer">RBAC</a></li>
<li>Machines access is configured using &quot;scopes&quot; and <a href="https://de.wikipedia.org/wiki/Role_Based_Access_Control" target="_blank" rel="noopener noreferrer">RBAC</a></li>
<li>Complex access configuration is expressed using <a href="https://en.wikipedia.org/wiki/Attribute-Based_Access_Control" target="_blank" rel="noopener noreferrer">ABAC</a>, using boolean expressions over both &quot;roles&quot; and &quot;scopes&quot;<!-- -->
<ul>
<li>example: hasRole(&quot;ADMIN&quot;) and hasScope(&quot;shop-manager.read&quot;, &quot;shop-manager.write&quot;)</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-using-jhipster-uaa">3. Using JHipster UAA<a class="hash-link" aria-label="Direct link to 3. Using JHipster UAA" title="Direct link to 3. Using JHipster UAA" href="/using-uaa/#3-using-jhipster-uaa">​</a></h2>
<p>When scaffolding a JHipster microservice, you may choose the UAA options instead of JWT authentication.</p>
<p><strong>Note</strong>: the UAA solution is also using JWT, which are addressable to custom configuration as well as JWT, using default Spring Cloud Security.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="basic-setup">Basic setup<a class="hash-link" aria-label="Direct link to Basic setup" title="Direct link to Basic setup" href="/using-uaa/#basic-setup">​</a></h3>
<p>The very basic setup consists of:</p>
<ol>
<li>A JHipster UAA server (as type of application)</li>
<li>At least one other microservice (using UAA authentication)</li>
<li>A JHipster gateway (using UAA authentication)</li>
</ol>
<p>This is the order in which it should be generated.</p>
<p>In addition to the authentication type, the location of the UAA must be provided.</p>
<p>For very basic usage, this setup is working the same way as it does for JWT authentication type, but with one more service.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="understanding-the-components">Understanding the components<a class="hash-link" aria-label="Direct link to Understanding the components" title="Direct link to Understanding the components" href="/using-uaa/#understanding-the-components">​</a></h3>
<p>The JHipster UAA server does three things out of the box:</p>
<ul>
<li>It serves the default JHipster user domain, containing user and account resource (this is done by gateway in JWT authentication)</li>
<li>It implements <code>AuthorizationServerConfigurerAdapter</code> for OAuth2 and is defining basic clients (&quot;web_app&quot; and &quot;internal&quot;)</li>
<li>It serves the JWT public key on <code>/oauth/token_key</code>, which has to be consumed by all other microservices</li>
</ul>
<p>The choices of a database, cache solution, search engine, build tools and further JHipster options are open to the developer.</p>
<p>When a microservice boots up, it usually expects the UAA server is already up to share its public key. The service first calls <code>/oauth/token_key</code> to fetch the public key and configure it for key signing (<code>JwtAccessTokenConverter</code>).</p>
<p>If the UAA is not up, the application will continue to start and fetch the public key at a later time. There are two properties - <code>uaa.signature-verification.ttl</code> controls how long the key lives before it is fetched again, <code>uaa.signature-verification.public-key-refresh-rate-limit</code> limits requests to UAA to avoid spamming it. These values are usually left at their default values. In any case, if verification fails, then the microservice will check if there&#x27;s a new key. That way, keys can be replaced on the UAA and the services will catch up.</p>
<p>From this point there are two use cases that may happen in this basic setup: user calls and machine calls.</p>
<p>For the user calls, a login request is sent to the gateway&#x27;s <code>/auth/login</code> endpoint. This endpoint uses <code>OAuth2TokenEndpointClientAdapter</code> to send a request to the UAA authenticating with the &quot;password&quot; grant. Because this request happens on the gateway, the client ID and secret are not stored in any client-side code and are inaccessible to users. The gateway returns a new Cookie containing the token, and this cookie is sent with each request performed from the client to the JHipster backend.</p>
<p>For the machine calls, the machine has to authenticate as a UAA using client credentials grant. JHipster provides a standard solution, described in <a href="/using-uaa/#4-secure-inter-service-communication-using-feign-clients">secure inter-service-communication using feign clients</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="refresh-tokens">Refresh Tokens<a class="hash-link" aria-label="Direct link to Refresh Tokens" title="Direct link to Refresh Tokens" href="/using-uaa/#refresh-tokens">​</a></h3>
<p>The general flow for refreshing access tokens happens on the gateway and is as follows:</p>
<ul>
<li>Authentication is done via <code>AuthResource</code> calling <code>OAuth2AuthenticationService</code>&#x27;s authenticate which will set Cookies.</li>
<li>For each request, the <code>RefreshTokenFilter</code> (installed by <code>RefreshTokenFilterConfigurer</code>) checks whether the access token is expired and whether it has a valid refresh token.</li>
<li>If so, then it triggers the refresh process via <code>OAuth2AuthenticationService</code> refreshToken.</li>
<li>This uses the <code>OAuth2TokenEndpointClient</code> interface to send a refresh token grant to the OAuth2 server of choice, in our case UAA (via <code>UaaTokenEndpointClient</code>).</li>
<li>The result of the refresh grant is then used downstream as new cookies and set upstream (to the browser) as new cookies.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="common-mistakes">Common mistakes<a class="hash-link" aria-label="Direct link to Common mistakes" title="Direct link to Common mistakes" href="/using-uaa/#common-mistakes">​</a></h3>
<p>Here is a brief list of the very major things a developer should be aware of.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-the-same-signing-key-for-production-and-staging"><strong><em>Using the same signing key for production and staging</em></strong><a class="hash-link" aria-label="Direct link to using-the-same-signing-key-for-production-and-staging" title="Direct link to using-the-same-signing-key-for-production-and-staging" href="/using-uaa/#using-the-same-signing-key-for-production-and-staging">​</a></h4>
<p>It is strictly recommended to use different signing keys as much as possible. Once a signing key gets into wrong hands, it is possible to generate full access granting key without knowing login credentials of any user.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="not-using-tls"><strong><em>Not using TLS</em></strong><a class="hash-link" aria-label="Direct link to not-using-tls" title="Direct link to not-using-tls" href="/using-uaa/#not-using-tls">​</a></h4>
<p>If attackers manage to intercept an access token, they will gain all the rights authorized to this token, until the token expires. There are a lot of ways to achieve that, in particular when there is no TLS encryption. This was not a problem in the days of version 1 of OAuth, because protocol level encryption was forced.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-access-tokens-in-url"><strong><em>Using access tokens in URL</em></strong><a class="hash-link" aria-label="Direct link to using-access-tokens-in-url" title="Direct link to using-access-tokens-in-url" href="/using-uaa/#using-access-tokens-in-url">​</a></h4>
<p>As of standard, access tokens can be either passed by URL, in headers, or in a cookie. From the TLS point of view, all three ways are secure. In practice passing tokens via URL is less secure, since there several ways of getting the URL from records.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="switching-to-symmetric-signing-keys"><strong><em>Switching to symmetric signing keys</em></strong><a class="hash-link" aria-label="Direct link to switching-to-symmetric-signing-keys" title="Direct link to switching-to-symmetric-signing-keys" href="/using-uaa/#switching-to-symmetric-signing-keys">​</a></h4>
<p>RSA is not required for JWT signing, and Spring Security does provide symmetric token signing as well. This also solves some problems, which make development harder. But this is insecure, since an attacker needs to get into one single microservice to be able to generate its own JWT tokens.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-secure-inter-service-communication-using-feign-clients">4. Secure inter-service-communication using Feign clients<a class="hash-link" aria-label="Direct link to 4. Secure inter-service-communication using Feign clients" title="Direct link to 4. Secure inter-service-communication using Feign clients" href="/using-uaa/#4-secure-inter-service-communication-using-feign-clients">​</a></h2>
<p>Currently only JHipster UAA is providing an scalable approach of secure inter-service-communication.</p>
<p>Using JWT authentication without manually forwarding JWTs from request to internal request forces microservices to call other microservices over the gateway, which involves additional internal requests per one master requests. But even with forwarding, it&#x27;s not possible to cleanly separate user and machine authentication.</p>
<p>Since JHipster UAA is based on OAuth2, all these problems are solved on protocol definition.</p>
<p>This chapter covers how to get started with this.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-eureka-ribbon-hystrix-and-feign">Using Eureka, Ribbon, Hystrix and Feign<a class="hash-link" aria-label="Direct link to Using Eureka, Ribbon, Hystrix and Feign" title="Direct link to Using Eureka, Ribbon, Hystrix and Feign" href="/using-uaa/#using-eureka-ribbon-hystrix-and-feign">​</a></h3>
<p>When one service wants to request data from another, finally all these four players come into play. So it is important, to briefly know what each of them is responsible for:</p>
<ul>
<li>Eureka: this is where services (un-)register, so you can ask &quot;foo-service&quot; and get a set of IPs of instances of the foo-service, registered in Eureka.</li>
<li>Ribbon: when someone asked for &quot;foo-service&quot; and already retrieved a set of IPs, Ribbon does the load balancing over these IPs.</li>
</ul>
<p>So to sum up, when we got a URL like &quot;<a href="http://uaa/oauth/token/" target="_blank" rel="noopener noreferrer">http://uaa/oauth/token/</a>&quot; with 2 instances of JHipster UAA server running on 10.10.10.1:9999 and 10.10.10.2:9999, we may use Eureka and Ribbon to quickly transform that URL either to &quot;<a href="http://10.10.10.1:9999/oauth/token" target="_blank" rel="noopener noreferrer">http://10.10.10.1:9999/oauth/token</a>&quot; or &quot;<a href="http://10.10.10.2:9999/oauth/token" target="_blank" rel="noopener noreferrer">http://10.10.10.2:9999/oauth/token</a>&quot; using a Round Robin algorithm.</p>
<ul>
<li>Hystrix: a circuit breaker system solving fall-back scenarios on service fails</li>
<li>Feign: using all that in a declarative style</li>
</ul>
<p>In real world, there is no warranty of all instances of all services to be up. So Hystrix works as a circuit breaker, to handle failure scenarios in a well-defined way, using fallbacks.</p>
<p>But wiring and coding all these things manually is a lot of work: Feign provides the option of writing <strong><em>Ribbon</em></strong> load balanced REST clients for endpoints registered in <strong><em>Eureka</em></strong>, with fallback implementations controlled using <strong><em>Hystrix</em></strong>, using nothing more then an Java interfaces with some annotations.</p>
<p>So for inter-service-communication, Feign clients are very helpful. When one service needs a REST client to access an &quot;other-service&quot;, serving some &quot;other-resource&quot;, it&#x27;s possible to declare an interface like:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@FeignClient</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;other-service&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">OtherServiceClient</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token annotation punctuation" style="color:#393A34">@RequestMapping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/api/other-resources&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">OtherResource</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getResourcesFromOtherService</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And then, using it via dependency injection, like:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@Service</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">SomeService</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token class-name">OtherServiceClient</span><span class="token plain"> otherServiceClient</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token annotation punctuation" style="color:#393A34">@Inject</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token class-name">SomeService</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">OtherServiceClient</span><span class="token plain"> otherServiceClient</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">otherServiceClient </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> otherServiceClient</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Similar to Spring Data JPA, there is no need to implement that interface. But you may do so, if using Hystrix. Implemented classes of Feign client interfaces act as fallback implementations.</p>
<p>One open issue is, to make this communication secure using UAA. To accomplish this, there should be some request interceptor for Feign, which implements the client credentials flow from OAuth, to authorize the current service for requesting the other service. In JHipster, you use <code>@AuthorizedFeignClients</code> instead. This is an annotation provided by JHipster, which does exactly that.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-authorizedfeignclients">Using <code>@AuthorizedFeignClients</code><a class="hash-link" aria-label="Direct link to using-authorizedfeignclients" title="Direct link to using-authorizedfeignclients" href="/using-uaa/#using-authorizedfeignclients">​</a></h3>
<p>Considering the above Feign client should be used to an &quot;other-service&quot;, which
serves protected resources, the interface must be annotated like this:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@AuthorizedFeignClient</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;other-service&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">OtherServiceClient</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token annotation punctuation" style="color:#393A34">@RequestMapping</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/api/other-resources&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">List</span><span class="token generics punctuation" style="color:#393A34">&lt;</span><span class="token generics class-name">OtherResource</span><span class="token generics punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getResourcesFromOtherService</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>note</strong>: Due to a bug in Spring Cloud, it&#x27;s currently not possible to use a different
notation for the service name, as</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@AuthorizedFeignClient</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;other-service&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>or</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@AuthorizedFeignClient</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;other-service&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The REST client automatically gets authorized with your UAA server, when there is no valid access token stored in memory.</p>
<p>This approach addresses a scenario when machine request run over a separate OAuth client not referring to an user session. This is important, in particular when entity auditing is used on a request, issued by another request in another service. As an alternative, the access token of the initial request may be forwarded to further calls. Currently, there is no &quot;default solution&quot; provided by JHipster.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-testing-uaa-applications">5. Testing UAA applications<a class="hash-link" aria-label="Direct link to 5. Testing UAA applications" title="Direct link to 5. Testing UAA applications" href="/using-uaa/#5-testing-uaa-applications">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mocking-feign-clients">Mocking Feign clients<a class="hash-link" aria-label="Direct link to Mocking Feign clients" title="Direct link to Mocking Feign clients" href="/using-uaa/#mocking-feign-clients">​</a></h3>
<p>Components working with Feign clients should be testable. Using Feign in tests the same way it is used in production would force the JHipster Registry and the UAA server to be up and reachable to the same machine where the tests are run. But in most cases, you don&#x27;t want to test that Feign itself works (it usually does), but your components using Feign clients.</p>
<p>To test components, which are using feign clients inside is possible using <code>@MockBean</code>, which is part of spring boot since 1.4.0.</p>
<p>Here is an example, testing <code>SomeService</code> works as expected, with mocked values for the client:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@RunWith</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">SpringRunner</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@SpringBootTest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">App</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">SomeServiceTest</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@MockBean</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token class-name">OtherServiceClient</span><span class="token plain"> otherServiceClient</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Inject</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token class-name">SomeService</span><span class="token plain"> someService</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#393A34">@Test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">testSomeService</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">given</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">otherServiceClient</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getResourcesFromOtherService</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">willReturn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Arrays</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">asList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">OtherResource</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        someService</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">performActionWhichInkvokesTheAboveMentionedMethod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">//assert that your application is in the desired state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>So with this technology you are simulating the behavior of the other service, and provide expected resource entity, which would come from the origin.
All Beans injecting a client will behave as mocked, so you can focus on the logic of these Beans.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="emulating-oauth2-authentication">Emulating OAuth2 authentication<a class="hash-link" aria-label="Direct link to Emulating OAuth2 authentication" title="Direct link to Emulating OAuth2 authentication" href="/using-uaa/#emulating-oauth2-authentication">​</a></h3>
<p>Using Spring&#x27;s integration tests against the REST controllers is usually bypassing the security configuration, since it would make testing hard, when the only intention is to prove the controller is functional doing what it should do. But sometimes, testing a controller&#x27;s security behavior is part of testing, too.</p>
<p>For this use-case, JHipster is providing an component called <code>OAuth2TokenMockUtil</code>, which can emulate a valid authentication without forcing the user or client to exist.</p>
<p>To use this feature, two things have to be done:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-enabling-security-in-the-mock-spring-mvc-context-and-inject-the-mock-util">1. Enabling security in the mock Spring MVC context and inject the mock util<a class="hash-link" aria-label="Direct link to 1. Enabling security in the mock Spring MVC context and inject the mock util" title="Direct link to 1. Enabling security in the mock Spring MVC context and inject the mock util" href="/using-uaa/#1-enabling-security-in-the-mock-spring-mvc-context-and-inject-the-mock-util">​</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@Inject</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token class-name">OAuth2TokenMockUtil</span><span class="token plain"> tokenUtil</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@PostConstruct</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">setup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">restMockMvc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">MockMvcBuilders</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">webAppContextSetup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">springSecurity</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">build</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong><em>In this test no single instance of the controller has to be mocked, but the
application&#x27;s <code>WebApplicationContext</code></em></strong></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-using-the-oauth2tokenmockutil">2. Using the <code>OAuth2TokenMockUtil</code><a class="hash-link" aria-label="Direct link to 2-using-the-oauth2tokenmockutil" title="Direct link to 2-using-the-oauth2tokenmockutil" href="/using-uaa/#2-using-the-oauth2tokenmockutil">​</a></h4>
<p>The util offers a method &quot;oaut2authentication&quot;, which is usable to MockMvc &quot;with&quot; notation. Currently it can be configured to mock a authentication with the following fields:</p>
<ul>
<li>username</li>
<li>roles (Set&lt;String&gt;)</li>
<li>scope (Set&lt;String&gt;)</li>
</ul>
<p>Here is an example:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token annotation punctuation" style="color:#393A34">@Test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">testInsufficientRoles</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    restMockMvc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">peform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;url/requiring/ADMIN/role&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">with</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tokenUtil</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">oauth2Authentication</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;unpriveleged.user@example.com&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Sets</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">newSet</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;some-scope&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Sets</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">newSet</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;ROLE_USER&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">andExpect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">status</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isForbidden</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/jhipster/jhipster.github.io/tree/main/docs/using-uaa.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2016-08-25T00:00:00.000Z" itemprop="dateModified">Aug 25, 2016</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a class="table-of-contents__link toc-highlight" href="/using-uaa/#architecture-diagram">Architecture diagram</a></li><li><a class="table-of-contents__link toc-highlight" href="/using-uaa/#1-security-claims-of-microservice-architecture">1. Security claims of microservice architecture</a><ul><li><a class="table-of-contents__link toc-highlight" href="/using-uaa/#1-central-authentication">1. Central authentication</a></li><li><a class="table-of-contents__link toc-highlight" href="/using-uaa/#2-statelessness">2. Statelessness</a></li><li><a class="table-of-contents__link toc-highlight" href="/using-uaa/#3-usermachine-access-distinction">3. User/machine access distinction</a></li><li><a class="table-of-contents__link toc-highlight" href="/using-uaa/#4-fine-grained-access-control">4. Fine-grained access control</a></li><li><a class="table-of-contents__link toc-highlight" href="/using-uaa/#5-safe-from-attacks">5. Safe from attacks</a></li><li><a class="table-of-contents__link toc-highlight" href="/using-uaa/#6-scalability">6. Scalability</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/using-uaa/#2-understanding-oauth2-in-this-context">2. Understanding OAuth2 in this context</a></li><li><a class="table-of-contents__link toc-highlight" href="/using-uaa/#3-using-jhipster-uaa">3. Using JHipster UAA</a><ul><li><a class="table-of-contents__link toc-highlight" href="/using-uaa/#basic-setup">Basic setup</a></li><li><a class="table-of-contents__link toc-highlight" href="/using-uaa/#understanding-the-components">Understanding the components</a></li><li><a class="table-of-contents__link toc-highlight" href="/using-uaa/#refresh-tokens">Refresh Tokens</a></li><li><a class="table-of-contents__link toc-highlight" href="/using-uaa/#common-mistakes">Common mistakes</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/using-uaa/#4-secure-inter-service-communication-using-feign-clients">4. Secure inter-service-communication using Feign clients</a><ul><li><a class="table-of-contents__link toc-highlight" href="/using-uaa/#using-eureka-ribbon-hystrix-and-feign">Using Eureka, Ribbon, Hystrix and Feign</a></li><li><a class="table-of-contents__link toc-highlight" href="/using-uaa/#using-authorizedfeignclients">Using <code>@AuthorizedFeignClients</code></a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/using-uaa/#5-testing-uaa-applications">5. Testing UAA applications</a><ul><li><a class="table-of-contents__link toc-highlight" href="/using-uaa/#mocking-feign-clients">Mocking Feign clients</a></li><li><a class="table-of-contents__link toc-highlight" href="/using-uaa/#emulating-oauth2-authentication">Emulating OAuth2 authentication</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer><div class="footerContent_o7UJ"><div class="footerCopyright_aFPy"><span>© 2013-<!-- -->2024<!-- --> JHipster</span><a href="/policies">Policies</a></div><ul class="socialLinks_XWB9"><li><a href="https://x.com/jhipster" target="_blank" rel="noopener noreferrer" aria-label="X"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"></path></svg></a></li><li><a href="https://github.com/jhipster/generator-jhipster" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></li><li><a href="https://www.youtube.com/c/JHipsterDevelopersAssociation" target="_blank" rel="noopener noreferrer" aria-label="YouTube channel"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 576 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"></path></svg></a></li><li><a href="https://gitter.im/jhipster/generator-jhipster" target="_blank" rel="noopener noreferrer" aria-label="Gitter"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 384 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M66.4 322.5H16V0h50.4v322.5zM166.9 76.1h-50.4V512h50.4V76.1zm100.6 0h-50.4V512h50.4V76.1zM368 76h-50.4v247H368V76z"></path></svg></a></li></ul></div></footer></div>
</body>
</html>