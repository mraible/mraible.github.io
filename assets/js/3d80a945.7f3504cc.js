"use strict";(self.webpackChunkjhipster_website=self.webpackChunkjhipster_website||[]).push([[5833],{93438:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>s,contentTitle:()=>a,default:()=>u,frontMatter:()=>i,metadata:()=>c,toc:()=>t});var o=l(74848),r=l(28453);const i={title:"Deploying to Clever Cloud",slug:"/clever-cloud/",last_update:{date:new Date("2020-10-09T00:00:00.000Z")}},a=void 0,c={id:"production/clever-cloud",title:"Deploying to Clever Cloud",description:"Clever cloud is an IT Automation platform",source:"@site/docs/production/clever-cloud.mdx",sourceDirName:"production",slug:"/clever-cloud/",permalink:"/clever-cloud/",draft:!1,unlisted:!1,editUrl:"https://github.com/jhipster/jhipster.github.io/tree/main/docs/production/clever-cloud.mdx",tags:[],version:"current",lastUpdatedAt:16022016e5,frontMatter:{title:"Deploying to Clever Cloud",slug:"/clever-cloud/",last_update:{date:"2020-10-09T00:00:00.000Z"}},sidebar:"docsSidebar",previous:{title:"Deploying with CloudCaptain",permalink:"/cloudcaptain/"},next:{title:"Deploying to Heroku",permalink:"/heroku/"}},s={},t=[{value:"Before you start",id:"before-you-start",level:2},{value:"Create your Clever Cloud application",id:"create-your-clever-cloud-application",level:2},{value:"Configure your JHipster application",id:"configure-your-jhipster-application",level:2},{value:"Deploy your application",id:"deploy-your-application",level:2},{value:"Using CLI",id:"using-cli",level:3},{value:"Using gitlab CI",id:"using-gitlab-ci",level:3},{value:"Using Github Action",id:"using-github-action",level:2},{value:"Changing the Java version",id:"changing-the-java-version",level:2},{value:"More information",id:"more-information",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.a,{href:"https://www.clever-cloud.com/",children:"Clever cloud"})," is an IT Automation platform"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.a,{href:"https://www.clever-cloud.com/",children:(0,o.jsx)("img",{src:"/images/logo/logo_clever_cloud.png",alt:"Clever cloud logo",width:"300px"})})}),"\n",(0,o.jsx)(n.h2,{id:"before-you-start",children:"Before you start"}),"\n",(0,o.jsxs)(n.p,{children:["You must install the ",(0,o.jsx)(n.a,{href:"https://www.clever-cloud.com/doc/clever-tools/getting_started/",children:"Clever cloud CLI"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["You must also ",(0,o.jsx)(n.a,{href:"https://api.clever-cloud.com/v2/sessions/signup",children:"create a Clever Cloud account"})," and log in with the CLI by running the following command ",(0,o.jsx)(n.code,{children:"clever login"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"Opening https://console.clever-cloud.com/cli-oauth?cli_version=2.7.1&cli_token=XXX in your browser to log you in\u2026\nLogin successful as ...\n"})}),"\n",(0,o.jsx)(n.h2,{id:"create-your-clever-cloud-application",children:"Create your Clever Cloud application"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["If you are using maven ",(0,o.jsx)(n.code,{children:"clever create --type maven [your application name]"})," or using gradle ",(0,o.jsx)(n.code,{children:"clever create --type gradle [your application name]"})]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Add a database addon to your application ",(0,o.jsx)(n.code,{children:"clever addon create [addon provider] [your addon name] --link [your application name]"})]}),"\n",(0,o.jsxs)(n.p,{children:["List supported addon providers ",(0,o.jsx)(n.code,{children:"clever addon providers"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"cellar-addon      Cellar S3 storage       S3-like online file storage web service\nconfig-provider   Configuration provider  Expose configuration to your applications  (via environment variables)\nes-addon          Elastic Stack           Elasticsearch with Kibana and APM server as options\nfs-bucket         FS Buckets              Persistent file system for your application\nmongodb-addon     MongoDB                 A noSQL document-oriented database\nmysql-addon       MySQL                   An open source relational database management system\npostgresql-addon  PostgreSQL              A powerful, open source object-relational database system\nredis-addon       Redis                   Redis by Clever Cloud is an in-memory key-value data store, powered by Clever Cloud\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.a,{href:"https://www.clever-cloud.com/doc/addons/clever-cloud-addons/#available-add-ons",children:"see supported addons"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Setup env var ",(0,o.jsx)(n.code,{children:'clever env set CC_PRE_RUN_HOOK "cp ./clevercloud/application-clevercloud.yml ./application-prod.yml"'})]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Enable dedicated build ",(0,o.jsx)(n.code,{children:"clever scale --build-flavor M"})]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.a,{href:"https://www.clever-cloud.com/doc/admin-console/apps-management/#dedicated-build",children:"see dedicated build"})}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"configure-your-jhipster-application",children:"Configure your JHipster application"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Add a ",(0,o.jsx)(n.code,{children:"clevercloud/"})," folder in your project."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["create ",(0,o.jsx)(n.code,{children:"clevercloud/application-clevercloud.yml"})," for using predefined clever cloud addon env var"]}),"\n",(0,o.jsx)(n.p,{children:"For PostgreSQL"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"spring:\n  datasource:\n    type: com.zaxxer.hikari.HikariDataSource        \n    url: jdbc:postgresql://${POSTGRESQL_ADDON_HOST}:${POSTGRESQL_ADDON_PORT}/${POSTGRESQL_ADDON_DB}?useUnicode=true&characterEncoding=utf8&useSSL=false\n    username: ${POSTGRESQL_ADDON_USER}\n    password: ${POSTGRESQL_ADDON_PASSWORD}\n    hikari:\n      maximumPoolSize: 2\n"})}),"\n",(0,o.jsx)(n.p,{children:"For MySQL"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"spring:\n  datasource:\n    type: com.zaxxer.hikari.HikariDataSource        \n    url: jdbc:mysql://${MYSQL_ADDON_HOST}:${MYSQL_ADDON_PORT}/${MYSQL_ADDON_DB}?useUnicode=true&characterEncoding=utf8&useSSL=false\n    username: ${MYSQL_ADDON_USER}\n    password: ${MYSQL_ADDON_PASSWORD}\n    hikari:\n      maximumPoolSize: 2\n"})}),"\n",(0,o.jsx)(n.p,{children:"For MongoDB"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"spring:\n  data:\n    mongodb:\n      uri: ${MONGODB_ADDON_URI}\n      database: ${MONGODB_ADDON_DB}\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"add a json file that contain the goal field to indicate how to start your application"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["For maven\ncreate ",(0,o.jsx)(n.code,{children:"clevercloud/maven.json"})," file and using your pom.xml ",(0,o.jsx)(n.strong,{children:"artifactId"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n  "build": {\n    "type": "maven",\n    "goal": "-Pprod package -DskipTests"\n  },\n  "deploy": {\n  "jarName": "./target/[REPLACE BY ARTIFACTID]-0.0.1-SNAPSHOT.jar"\n  }\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["For gradle\ncreate ",(0,o.jsx)(n.code,{children:"clevercloud/gradle.json"})," file  and using gradle.properties ",(0,o.jsx)(n.strong,{children:"rootProject.name"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n  "build": {\n    "type": "gradle",\n    "goal": "-Pprod bootJar -x test"\n  },\n  "deploy": {\n    "jarName": "./build/libs/[REPLACE BY rootProject.name]-0.0.1-SNAPSHOT.jar"\n  }\n}\n'})}),"\n",(0,o.jsx)(n.h2,{id:"deploy-your-application",children:"Deploy your application"}),"\n",(0,o.jsx)(n.h3,{id:"using-cli",children:"Using CLI"}),"\n",(0,o.jsx)(n.p,{children:"You must commit before deploy"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:'git commit -m "Clever deploy"\n'})}),"\n",(0,o.jsx)(n.p,{children:"then run:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"clever deploy\n"})}),"\n",(0,o.jsx)(n.h3,{id:"using-gitlab-ci",children:"Using gitlab CI"}),"\n",(0,o.jsxs)(n.p,{children:["define ",(0,o.jsx)(n.code,{children:"$CLEVER_TOKEN"})," and ",(0,o.jsx)(n.code,{children:"CLEVER_SECRET"})," to gitlab CI/CD environment variables"]}),"\n",(0,o.jsxs)(n.p,{children:["add this stage to your ",(0,o.jsx)(n.code,{children:".gitlab-ci.yml"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"deploy-to-clever-env:\n  stage: deploy\n  variables:\n    APP_NAME: [clever cloud app name]\n    APP_ID: [clever cloud app id]\n  script:\n    - wget https://clever-tools.cellar.services.clever-cloud.com/releases/latest/clever-tools-latest_linux.tar.gz\n    - tar xvzf clever-tools-latest_linux.tar.gz\n    - ./clever-tools-latest_linux/clever login --token $CLEVER_TOKEN --secret $CLEVER_SECRET\n    - ./clever-tools-latest_linux/clever link ${APP_ID}\n    - ./clever-tools-latest_linux/clever deploy -a ${APP_NAME}\n  environment:\n    name: [env name]\n    url: https://${APP_NAME}.cleverapps.io\n"})}),"\n",(0,o.jsx)(n.h2,{id:"using-github-action",children:"Using Github Action"}),"\n",(0,o.jsxs)(n.p,{children:["define ",(0,o.jsx)(n.code,{children:"CLEVER_TOKEN"})," and ",(0,o.jsx)(n.code,{children:"CLEVER_SECRET"})," to Github secret (Settings > Secret)"]}),"\n",(0,o.jsxs)(n.p,{children:["add this step to your ",(0,o.jsx)(n.code,{children:".github-action.yml"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"- uses: actions/checkout@v2\n- name: Deploy on cc\n  env:\n    APP_NAME:[clever cloud app name]\n    APP_ID: [clever cloud app id]\n  run: |\n    git fetch --prune --unshallow\n    wget https://clever-tools.cellar.services.clever-cloud.com/releases/latest/clever-tools-latest_linux.tar.gz\n    tar xvzf clever-tools-latest_linux.tar.gz\n    ./clever-tools-latest_linux/clever login --token ${{ secrets.CLEVER_TOKEN }} --secret ${{ secrets.CLEVER_SECRET }}\n    ./clever-tools-latest_linux/clever link ${{ env.APP_ID }}\n    ./clever-tools-latest_linux/clever deploy -f -a ${{ env.APP_NAME }}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"changing-the-java-version",children:"Changing the Java version"}),"\n",(0,o.jsx)(n.p,{children:"You can select the Java version (Java 11 by default)"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"clever env set CC_JAVA_VERSION 12\n"})}),"\n",(0,o.jsx)(n.h2,{id:"more-information",children:"More information"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://www.clever-cloud.com/doc/",children:"Clever Cloud documentation"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://www.clever-cloud.com/doc/java/java-maven/",children:"Clever Cloud Java maven deployment"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://www.clever-cloud.com/doc/java/java-gradle/",children:"Clever Cloud Java gradle deployment"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},28453:(e,n,l)=>{l.d(n,{R:()=>a,x:()=>c});var o=l(96540);const r={},i=o.createContext(r);function a(e){const n=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);