"use strict";(self.webpackChunkjhipster_website=self.webpackChunkjhipster_website||[]).push([[7851],{40454:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>d});var t=i(74848),r=i(28453);const s={title:"Separating the front-end and the API server",slug:"/separating-front-end-and-api/",last_update:{date:new Date("2021-03-08T12:00:00.000Z")}},o=void 0,a={id:"development/separating-front-end-and-api",title:"Separating the front-end and the API server",description:"Introduction",source:"@site/docs/development/separating-front-end-and-api.mdx",sourceDirName:"development",slug:"/separating-front-end-and-api/",permalink:"/separating-front-end-and-api/",draft:!1,unlisted:!1,editUrl:"https://github.com/jhipster/jhipster.github.io/tree/main/docs/development/separating-front-end-and-api.mdx",tags:[],version:"current",lastUpdatedAt:16152048e5,frontMatter:{title:"Separating the front-end and the API server",slug:"/separating-front-end-and-api/",last_update:{date:"2021-03-08T12:00:00.000Z"}},sidebar:"docsSidebar",previous:{title:"Common ports",permalink:"/common-ports/"},next:{title:"Managing server errors",permalink:"/managing-server-errors/"}},c={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Generating only a front-end or a back-end application",id:"generating-only-a-front-end-or-a-back-end-application",level:2},{value:"Directory layout",id:"directory-layout",level:2},{value:"HTTP requests routing and caching",id:"http-requests-routing-and-caching",level:2},{value:"Using BrowserSync",id:"using-browsersync",level:2},{value:"Using CORS",id:"using-cors",level:2},{value:"Using NGinx",id:"using-nginx",level:2},{value:"Configuration lambda",id:"configuration-lambda",level:3}];function l(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,t.jsx)(n.p,{children:'JHipster is a "full-stack" development tool, and its goal is to make you work efficiently with your front-end code (Angular/React) and your back-end code (Spring Boot).'}),"\n",(0,t.jsx)(n.p,{children:"However, it is a common requirement to separate the front-end and the back-end codes, typically because they are developed by different teams and have a different lifecycle."}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Please note"})," that this isn't the default JHipster way of working: this isn't complex to do, and works well, but this is an advanced topic. If you are getting started with JHipster, we recommend that you begin by using our standard way of working."]}),"\n",(0,t.jsx)(n.h2,{id:"generating-only-a-front-end-or-a-back-end-application",children:"Generating only a front-end or a back-end application"}),"\n",(0,t.jsxs)(n.p,{children:["You can choose to generate only a JHipster back-end or JHipster front-end application. At generation time, this is only a matter of choosing flags which are described in our ",(0,t.jsx)(n.a,{href:"/creating-an-app",children:"application generation documentation"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"jhipster --skip-client"})," will only generate a back-end application (this is typically what JHipster microservices are)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"jhipster --skip-server [options]"})," will only generate a front-end application (e.g. ",(0,t.jsx)(n.code,{children:"jhipster --skip-server --db=sql --auth=jwt"}),")"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"This should only work well for monoliths, as this doesn't make much sense for microservices (which have no front-end anyway) and gateways (which are monoliths with the Spring Cloud Gateway service enabled)."}),"\n",(0,t.jsx)(n.h2,{id:"directory-layout",children:"Directory layout"}),"\n",(0,t.jsxs)(n.p,{children:["JHipster uses the standard Maven directory layout. When working on the back-end, you can read the ",(0,t.jsx)(n.a,{href:"https://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html",children:"Maven standard directory layout documentation"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"When working on the front-end, there are 2 directories you need to know:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"src/main/webapp"})," is where the client application will be developed"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"target/classes/static"})," is where your client application will be packaged"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"If you have separate teams working on the front-end and back-end, you have two solutions:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Both teams can work on the same project. As the directories are separated, there won't have much conflicts between teams. To make things even cleaner, both teams could work on separate branches."}),"\n",(0,t.jsx)(n.li,{children:"The front-end code can be stored in a specific Git project, and then imported into the main back-end project as a Git sub-module. This would require to move the client-side build scripts."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"http-requests-routing-and-caching",children:"HTTP requests routing and caching"}),"\n",(0,t.jsx)(n.p,{children:"Once the front-end and back-end have been separated, the issue will be how to handle HTTP requests:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["All API calls will use a ",(0,t.jsx)(n.code,{children:"/api"})," prefix. If you are using Angular, there is also a specific ",(0,t.jsx)(n.code,{children:"SERVER_API_URL"})," constant, defined in the ",(0,t.jsx)(n.code,{children:"webpack.common.js"})," configuration, that can enrich this prefix. For example, you can use ",(0,t.jsx)(n.code,{children:'"http://api.jhipster.tech:8081/"'})," as a back-end API server (If you do this, please read our documentation on CORS below)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"/index.html"})," should not be cached by the browser or server."]}),"\n",(0,t.jsxs)(n.li,{children:["Calls to ",(0,t.jsx)(n.code,{children:"/"})," that serve static assets (from the front-end) ",(0,t.jsx)(n.code,{children:"/app"})," (which contains the client-side application) and ",(0,t.jsx)(n.code,{children:"/content"})," (which contains the static content, like images and CSS) should be cached in production, as those assets are hashed."]}),"\n",(0,t.jsxs)(n.li,{children:["Calls to ",(0,t.jsx)(n.code,{children:"/i18n"})," can be cached but files itsefs not are hashed, url query string are used"]}),"\n",(0,t.jsxs)(n.li,{children:["Calls to a non-existent route should forward the request to ",(0,t.jsx)(n.code,{children:"index.html"}),". This is normally handled in the backend through ",(0,t.jsx)(n.code,{children:"ClientForwardController"}),". When deploying the client separately, this needs to be configured.  See the ",(0,t.jsx)(n.a,{href:"https://angular.io/guide/deployment#server-configuration",children:"Angular"})," or ",(0,t.jsx)(n.a,{href:"https://facebook.github.io/create-react-app/docs/deployment",children:"React"})," documentation for several examples."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"using-browsersync",children:"Using BrowserSync"}),"\n",(0,t.jsxs)(n.p,{children:["In ",(0,t.jsx)(n.code,{children:"dev"})," mode, JHipster uses BrowserSync for hot-reload of the front-end application. BrowserSync has a proxy (",(0,t.jsx)(n.a,{href:"https://www.browsersync.io/docs/options#option-proxy",children:"here is its documentation"}),") that will route requests from ",(0,t.jsx)(n.code,{children:"/api"})," to a back-end server (by default, ",(0,t.jsx)(n.code,{children:"http://127.0.0.1:8080"}),")."]}),"\n",(0,t.jsxs)(n.p,{children:["This only works in ",(0,t.jsx)(n.code,{children:"dev"})," mode, but this is a very powerful way of accessing different API servers from the front-end."]}),"\n",(0,t.jsx)(n.h2,{id:"using-cors",children:"Using CORS"}),"\n",(0,t.jsxs)(n.p,{children:["CORS (",(0,t.jsx)(n.a,{href:"https://wikipedia.org/wiki/Cross-origin_resource_sharing",children:"Cross-origin request sharing"}),") allow to access different back-end servers with the same front-end, without configuring a proxy."]}),"\n",(0,t.jsx)(n.p,{children:"This is an easy-to-use solution, but it can be less secure in production."}),"\n",(0,t.jsx)(n.p,{children:"JHipster provides out-of-the-box a CORS configuration:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["CORS can be configured using the ",(0,t.jsx)(n.code,{children:"jhipster.cors"})," property, as defined in ",(0,t.jsx)(n.a,{href:"/common-application-properties/",children:"the JHipster common application properties"})]}),"\n",(0,t.jsxs)(n.li,{children:["It is enabled by default in ",(0,t.jsx)(n.code,{children:"dev"})," mode for monoliths and gateways. It is turned off by default for microservices as you are supposed to access them through a gateway."]}),"\n",(0,t.jsxs)(n.li,{children:["It is turned off by default in ",(0,t.jsx)(n.code,{children:"prod"})," mode, for security reasons."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"using-nginx",children:"Using NGinx"}),"\n",(0,t.jsx)(n.p,{children:"Another solution to separate the front-end and back-end codes is to use a proxy server. This is very common in production, and some teams also use this technique in development."}),"\n",(0,t.jsx)(n.p,{children:"This configuration will change depending on your specific use-case, so this cannot be automated by the generator, here is below a working configuration."}),"\n",(0,t.jsxs)(n.p,{children:["Create a ",(0,t.jsx)(n.code,{children:"src/main/docker/nginx.yml"})," Docker Compose file:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"version: '2'\nservices:\n  nginx:\n    image: nginx:1.15-alpine\n    volumes:\n    - ./../../../target/static:/usr/share/nginx/html\n    - ./nginx/site.conf:/etc/nginx/conf.d/default.conf\n    ports:\n    - \"8000:80\"\n"})}),"\n",(0,t.jsxs)(n.p,{children:["This Docker image will configure an NGinx server, that reads the static assets from ",(0,t.jsx)(n.code,{children:"target/static"}),": this is where the JHipster front-end application is generated by default. In production, you will probably have a specific folder for this."]}),"\n",(0,t.jsxs)(n.p,{children:["It also reads a ",(0,t.jsx)(n.code,{children:"./nginx/site.conf"})," file: this is a NGinx-specific configuration file."]}),"\n",(0,t.jsx)(n.h3,{id:"configuration-lambda",children:"Configuration lambda"}),"\n",(0,t.jsxs)(n.p,{children:["Here is a sample ",(0,t.jsx)(n.code,{children:"site.conf"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"server {\n    listen 80;\n    index index.html;\n    server_name localhost;\n    error_log  /var/log/nginx/error.log;\n\n    root /usr/share/nginx/html;\n\n    location /api {\n        proxy_pass http://api.jhipster.tech:8081/api;\n    }\n    location /management {\n        proxy_pass http://api.jhipster.tech:8081/management;\n    }\n    location /swagger-resources {\n        proxy_pass http://api.jhipster.tech:8081/swagger-resources;\n    }        \n    location /v2 {\n        proxy_pass http://api.jhipster.tech:8081/v2;\n    }\n    location /auth {\n        proxy_pass http://api.jhipster.tech:8081/auth;\n    }\n\n    location / {\n        try_files $uri $uri/ /index.html;\n    }\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"This configuration means that:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["NGinx will run on port ",(0,t.jsx)(n.code,{children:"80"})]}),"\n",(0,t.jsxs)(n.li,{children:["It will read the static assets in folder ",(0,t.jsx)(n.code,{children:"/usr/share/nginx/html"}),", and"]}),"\n",(0,t.jsxs)(n.li,{children:["It will act as a proxy from ",(0,t.jsx)(n.code,{children:"/api"})," to ",(0,t.jsx)(n.code,{children:"http://api.jhipster.tech:8081/api"})]}),"\n",(0,t.jsxs)(n.li,{children:["Any unhandled requests will forward to ",(0,t.jsx)(n.code,{children:"index.html"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"This configuration will require some tuning depending on your specific needs, but should be a good enough starting point for most applications."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>a});var t=i(96540);const r={},s=t.createContext(r);function o(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);